<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/template/main.xhtml">
	

	<ui:define name="content">

		<div class="ui-g-12 titulo">
			<h1>Pedidos da venda</h1>
		</div>


		<h:form id="formAddItens">


			<div class="ui-g-12 ui-md-6 ui-lg-6 botoes"></div>
		</h:form>

		<h:form id="formDadosFornecedor">
			<p:focus context="formDadosFornecedor" />
			<p:fieldset legend="Dados do Fornecedor">

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Fornecedor" for="fornecedorDocumento" />
						<p:inputText id="fornecedorDocumento"
							value="#{pedidoCompraControle.fornecedorDocumento}"
							styleClass="form-normal" required="true"
							requiredMessage="Fornecedor obrigatório" maxlength="80">
							<p:clientValidator event="blur" />
							<p:ajax event="keyup" process="@this" update="fornecedor"
								listener="#{pedidoCompraControle.getFornecedorPorDocumento}" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="fornecedorDocumento" id="fornecedorDocumentoMessage" />
					</div>
				</div>


				<div class="ui-g">
					<div class="ui-g-12 ui-md-12 ui-lg-6">
						<div class="ui-inputgroup">
							<p:inputText placeholder="Fornecedor" id="fornecedor"
								value="#{pedidoCompraControle.fornecedor.nome}"
								styleClass="form-normal" required="true" readonly="true" />
							<p:commandButton icon="fa fa-search" styleClass="white-button"
								process="@this" update="fornecedor"
								actionListener="#{dialogControle.fornecedorConsultaDialogShow}">
								<p:ajax event="dialogReturn" process="@this"
									update="fornecedor fornecedorDocumento"
									listener="#{pedidoCompraControle.fornecedorSelecionado}" />
							</p:commandButton>
						</div>
					</div>
					<div class="ui-g-6 ui-md-6 ui-lg-6 form-messages">
						<p:message for="fornecedor" id="fornecedorMessage" />
					</div>
				</div>
				
				
				
				
				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Funcionario" for="funcionarioDocumento" />
						<p:inputText id="funcionarioDocumento"
							value="#{pedidoCompraControle.funcionarioDocumento}"
							styleClass="form-normal" required="true"
							requiredMessage="Funcionario obrigatório" maxlength="80">
							<p:clientValidator event="blur" />
							<p:ajax event="keyup" process="@this" update="funcionario"
								listener="#{pedidoCompraControle.getFuncionarioPorDocumento}" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="funcionarioDocumento" id="funcionarioDocumentoMessage" />
					</div>
				</div>


				<div class="ui-g">
					<div class="ui-g-12 ui-md-12 ui-lg-6">
						<div class="ui-inputgroup">
							<p:inputText placeholder="Funcionario" id="funcionario"
								value="#{pedidoCompraControle.funcionario.nome}"
								styleClass="form-normal" required="true" readonly="true" />
							<p:commandButton icon="fa fa-search" styleClass="white-button"
								process="@this" update="funcionario"
								actionListener="#{dialogControle.funcionarioConsultaDialogShow}">
								<p:ajax event="dialogReturn" process="@this"
									update="funcionario funcionarioDocumento"
									listener="#{pedidoCompraControle.funcionarioSelecionado}" />
							</p:commandButton>
						</div>
					</div>
					<div class="ui-g-6 ui-md-6 ui-lg-6 form-messages">
						<p:message for="funcionario" id="funcionarioMessage" />
					</div>
				</div>
				
			</p:fieldset>
		</h:form>

		<h:form id="formDadosItem">
			<p:focus context="formDadosItem" />
			<p:fieldset legend="Item">

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="ItemDeProducao" for="itemDeProducaoCodigo" />
						<p:inputText id="itemDeProducaoCodigo"
							value="#{pedidoCompraControle.itemDeProducaoCodigo}"
							styleClass="form-normal" required="true"
							requiredMessage="Codigo do itemDeProducao obrigatório" maxlength="80">
							<p:clientValidator event="blur" />
							<p:ajax event="keyup" process="@this"
								update="itemDeProducao unidadeDeMedida unidadeDeMedidaSigla"
								listener="#{pedidoCompraControle.getItemDeProducaoPorCodigo}" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="itemDeProducaoCodigo" id="itemDeProducaoCodigoMessage" />
					</div>
				</div>


				<div class="ui-g">
					<div class="ui-g-12 ui-md-12 ui-lg-6">
						<div class="ui-inputgroup">
							<p:inputText placeholder="ItemDeProducao" id="itemDeProducao"
								value="#{pedidoCompraControle.itemDeProducao.nome}"
								styleClass="form-normal" required="true" readonly="true" />
							<p:commandButton icon="fa fa-search" styleClass="white-button"
								process="@this" update="itemDeProducaoCodigo"
								actionListener="#{dialogControle.itemDeProducaoConsultaDialogShow}">
								<p:ajax event="dialogReturn" process="@this"
									update="itemDeProducao itemDeProducaoCodigo unidadeDeMedida unidadeDeMedidaSigla"
									listener="#{pedidoCompraControle.itemDeProducaoSelecionado}" />
							</p:commandButton>
						</div>
					</div>
					<div class="ui-g-6 ui-md-6 ui-lg-6 form-messages">
						<p:message for="itemDeProducao" id="itemDeProducaoMessage" />
					</div>
				</div>

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Unidade de Medida"
							for="unidadeDeMedidaSigla" />
						<p:inputText placeholder="Sigla" id="unidadeDeMedidaSigla"
							value="#{pedidoCompraControle.itemDeProducao.unidadeDeMedida.sigla}"
							styleClass="form-normal" required="true" readonly="true">
						</p:inputText>
					</div>
				</div>

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:inputText placeholder="Nome" id="unidadeDeMedida"
							value="#{pedidoCompraControle.itemDeProducao.unidadeDeMedida.nome}"
							styleClass="form-normal" required="true" readonly="true">
						</p:inputText>
					</div>
				</div>

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Quantidade" for="quantidade" />
						<p:inputText id="quantidade"
							value="#{pedidoCompraControle.itemDaCompra.quantidade}"
							styleClass="form-normal" required="true"
							requiredMessage="Quantidade obrigatório"
							validatorMessage="Quantidade deve ser um número inteiro ou decimal"
							maxlength="80">
							<p:ajax event="keyup" process="@this" update="precoTotal"
								listener="#{pedidoCompraControle.calculaPrecoTotal()}" />
							<p:clientValidator event="blur" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="quantidade" id="quantidadeMessage" />
					</div>
				</div>

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Valor unitário" for="precoUnitario" />
						<p:inputText id="precoUnitario"
							value="#{pedidoCompraControle.itemDaCompra.precoUnitario}"
							styleClass="form-normal" required="true"
							requiredMessage="precoUnitario do item obrigatório"
							validatorMessage="precoUnitario do item deve ter no minimo 2 caracteres"
							maxlength="80">
							<p:clientValidator event="blur" />
							<p:ajax event="keyup" process="@this" update="precoTotal"
								listener="#{pedidoCompraControle.calculaPrecoTotal}" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="precoUnitario" id="precoUnitarioMessage" />
					</div>
				</div>

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Valor total" for="precoTotal" />
						<p:inputText id="precoTotal"
							value="#{pedidoCompraControle.itemDaCompra.precoTotal}"
							styleClass="form-normal" required="true"
							requiredMessage="precoTotal do item obrigatório"
							validatorMessage="precoTotal do item deve ter no minimo 2 caracteres"
							maxlength="80">
							<p:clientValidator event="blur" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="precoTotal" id="precoTotalMessage" />
					</div>
				</div>

			</p:fieldset>

			<div class="botoes-cadastrar">
				<p:commandButton id="salvar" value="Adicionar"
					action="#{pedidoCompraControle.adicionarItem}" process="@this @form"
					update="@form" icon="fa fa-fw fa-save" validateClient="true" />
				<p:commandButton value="Limpar" type="reset"
					icon="fa fa-fw fa-eraser" update="@form" />
			</div>
		</h:form>

		<div></div>


		<h:form id="formTabelaItens">
			<p:dataTable id="itens" var="itemDaCompra"
				value="#{pedidoCompraControle.itensDaVenda}" resizableColumns="true"
				reflow="true" rows="10" paginator="true"
				paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="10,25,50" draggableColumns="true"
				rowKey="#{itemDaCompra.itemDeProducao.id}"
				selection="#{pedidoCompraControle.itemDaCompra}"
				selectionMode="single" emptyMessage="Nenhum item!"
				styleClass="ui-g-12">

				<f:facet name="header">Lista de itens do pedido
				
				</f:facet>

				<p:column headerText="Id" sortBy="#{itemDaCompra.id}">
					<h:outputText value="#{itemDaCompra.id}" />
				</p:column>

				<p:column headerText="Item" sortBy="#{itemDaCompra.itemDeProducao.nome}">
					<h:outputText value="#{itemDaCompra.itemDeProducao.nome}" />
				</p:column>


				<p:column headerText="Quantidade" sortBy="#{itemDaCompra.quantidade}">
					<h:outputText value="#{itemDaCompra.quantidade}" />
				</p:column>

				<p:column headerText="Valor unitario"
					sortBy="#{itemDaCompra.precoUnitario}">
					<h:outputText value="#{itemDaCompra.precoUnitario}" />
				</p:column>

				<p:column headerText="Valor total"
					sortBy="#{itemDaCompra.precoTotal}">
					<h:outputText value="#{itemDaCompra.precoTotal}" />
				</p:column>


				<p:column headerText="Ação" style="width: 7ch;" priority="6">
					<p:commandButton icon="fa fa-fw fa-times"
						styleClass="tab-btn btn-desativar" value="Remover"
						action="#{pedidoCompraControle.removerItem(itemDaCompra)}"
						update="@form" process="@this @form">
					</p:commandButton>
				</p:column>



				<f:facet name="footer">
					Total de itens: 
					<h:outputText value=" #{pedidoCompraControle.totalDeItens}" />
				</f:facet>

				<p:ajax event="rowDblselect" oncomplete="PF('vendaDialog').show()"
					update="@form" global="false" />
			</p:dataTable>
		</h:form>

		<h:form id="formDadosPagamento">
			<p:focus context="formDadosPagamento" />
			<p:fieldset legend="Pagamento">

				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Valor total" for="precoTotal" />
						<p:inputText id="precoTotal"
							value="#{pedidoCompraControle.pedidoCompra.precoTotal}"
							styleClass="form-normal"
							readonly="true"
							maxlength="80">
							<p:clientValidator event="blur" />
						</p:inputText>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="precoTotal" id="precoTotalMessage" />
					</div>
				</div>
				
				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Vencimento" for="vencimento" />
						<p:calendar id="vencimento"
							value="#{pedidoCompraControle.pedidoCompra.vencimento}"
							styleClass="form-normal" required="true"
							maxlength="80">
							<f:convertDateTime type="date" pattern="dd/mm/yy" />
							<p:clientValidator event="blur" />
						</p:calendar>
						<p:watermark  value="DD/MM/YY" for="vencimento" />
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="vencimento" id="vencimentoMessage" />
					</div>
				</div>
				
				<div class="ui-g">
					<div class="ui-g-12 ui-md-6 ui-lg-6">
						<p:outputLabel value="Emissao" for="emissao" />
						<p:inputMask id="emissao"
							value="#{pedidoCompraControle.pedidoCompra.dataCadastro}"
							styleClass="form-normal" required="true"
							readonly="true"
							maxlength="80">
							<p:clientValidator event="blur" />
						</p:inputMask>
						<p:watermark  value="DD/MM/YYYY" for="emissao"/>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-6 form-messages">
						<p:message for="emissao" id="emissaoMessage" />
					</div>
				</div>
	
				<div class="ui-g">
					<div class="ui-g-12 ui-md-12 ui-lg-6">
						<p:outputLabel value="Tipo:" for="tipoDePagamento" />
						<p:selectOneMenu label="Forma pagamento"
							styleClass="form-normal"
							value="#{pedidoCompraControle.conta.tipoDePagamento}" id="tipoDePagamento"
							required="true" requiredMessage="Selecione uma opção de pagamento">
							<f:selectItems value="#{pedidoCompraControle.enumTipoPagamento}" var="tipo"
								itemValue="#{tipo}" itemLabel="#{tipo.label}" />
							<p:clientValidator event="blur" /> 
						</p:selectOneMenu>
					</div>
					<div class="ui-g-12 ui-md-12 ui-lg-6 form-messages">
						<p:message for="tipoDePagamento" id="tipoDePagamentoMessage" />
					</div>
				</div>
				
				<div class="ui-g">
					<div class="ui-g-12 ui-md-12 ui-lg-6">
						<p:outputLabel value="Status" for="statusPagamento" />
						<p:selectOneMenu label="Status do pagamento"
							styleClass="form-normal"
							value="#{pedidoCompraControle.conta.statusPagamento}" id="statusPagamento"
							required="true" requiredMessage="Selecione um status">
							<f:selectItems value="#{pedidoCompraControle.enumStatusPagamento}" var="tipo"
								itemValue="#{tipo}" itemLabel="#{tipo.label}" />
							<p:clientValidator event="blur" /> 
						</p:selectOneMenu>
					</div>
					<div class="ui-g-12 ui-md-12 ui-lg-6 form-messages">
						<p:message for="statusPagamento" id="statusPagamentoMessage" />
					</div>
				</div>


			</p:fieldset>
				<div class="botoes-cadastrar">
				<p:commandButton id="salvarTudo" value="Salvar" actionListener="#{pedidoCompraControle.salvarTudo}"
					action="#{pedidoCompraControle.index}" process="@this @form"
					update="@form" icon="fa fa-fw fa-save"
					validateClient="true" />
				<p:commandButton value="Limpar" type="reset"
					icon="fa fa-fw fa-eraser" update="@form" />
			</div>
			
		</h:form>
	</ui:define>





</ui:composition>
</html>
